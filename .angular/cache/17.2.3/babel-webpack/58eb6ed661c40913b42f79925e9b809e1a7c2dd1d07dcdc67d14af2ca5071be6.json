{"ast":null,"code":"import { FormControl, FormGroup, Validators } from \"@angular/forms\";\nimport { BehaviorSubject } from \"rxjs\";\nimport { HostService } from \"app/service/bhaki-service\";\nimport { NotificationService } from \"app/service/notificationService\";\nimport { TokenStorageService } from \"app/components/login/services/token-storage.service\";\nimport * as i0 from \"@angular/core\";\nimport * as i1 from \"app/service/bhaki-service\";\nimport * as i2 from \"app/service/notificationService\";\nimport * as i3 from \"app/components/login/services/token-storage.service\";\nimport * as i4 from \"@angular/common\";\nimport * as i5 from \"@angular/forms\";\nimport * as i6 from \"@angular/material/button\";\nimport * as i7 from \"@angular/material/form-field\";\nimport * as i8 from \"@angular/material/input\";\nimport * as i9 from \"@angular/material/select\";\nimport * as i10 from \"@angular/material/core\";\nfunction ManageCourseComponent_div_2_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelement(0, \"div\", 4);\n  }\n}\nfunction ManageCourseComponent_div_3_mat_option_14_Template(rf, ctx) {\n  if (rf & 1) {\n    const _r7 = i0.ɵɵgetCurrentView();\n    i0.ɵɵelementStart(0, \"mat-option\", 28);\n    i0.ɵɵlistener(\"click\", function ManageCourseComponent_div_3_mat_option_14_Template_mat_option_click_0_listener() {\n      const restoredCtx = i0.ɵɵrestoreView(_r7);\n      const course_r5 = restoredCtx.$implicit;\n      const ctx_r6 = i0.ɵɵnextContext(2);\n      return i0.ɵɵresetView(ctx_r6.validateBranchSelection(course_r5));\n    });\n    i0.ɵɵtext(1);\n    i0.ɵɵelementEnd();\n  }\n  if (rf & 2) {\n    const course_r5 = ctx.$implicit;\n    i0.ɵɵproperty(\"value\", course_r5.name);\n    i0.ɵɵadvance();\n    i0.ɵɵtextInterpolate(course_r5.name);\n  }\n}\nfunction ManageCourseComponent_div_3_mat_option_21_Template(rf, ctx) {\n  if (rf & 1) {\n    const _r10 = i0.ɵɵgetCurrentView();\n    i0.ɵɵelementStart(0, \"mat-option\", 28);\n    i0.ɵɵlistener(\"click\", function ManageCourseComponent_div_3_mat_option_21_Template_mat_option_click_0_listener() {\n      const restoredCtx = i0.ɵɵrestoreView(_r10);\n      const course_r8 = restoredCtx.$implicit;\n      const ctx_r9 = i0.ɵɵnextContext(2);\n      return i0.ɵɵresetView(ctx_r9.validateCourseSelection(course_r8));\n    });\n    i0.ɵɵtext(1);\n    i0.ɵɵelementEnd();\n  }\n  if (rf & 2) {\n    const course_r8 = ctx.$implicit;\n    i0.ɵɵproperty(\"value\", course_r8.name);\n    i0.ɵɵadvance();\n    i0.ɵɵtextInterpolate(course_r8.name);\n  }\n}\nfunction ManageCourseComponent_div_3_div_44_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"div\")(1, \"p\");\n    i0.ɵɵtext(2, \"Selected branch \");\n    i0.ɵɵelementStart(3, \"strong\");\n    i0.ɵɵtext(4);\n    i0.ɵɵelementEnd()()();\n  }\n  if (rf & 2) {\n    const ctx_r4 = i0.ɵɵnextContext(2);\n    i0.ɵɵadvance(4);\n    i0.ɵɵtextInterpolate(ctx_r4.selectedBranch == null ? null : ctx_r4.selectedBranch.name);\n  }\n}\nfunction ManageCourseComponent_div_3_Template(rf, ctx) {\n  if (rf & 1) {\n    const _r12 = i0.ɵɵgetCurrentView();\n    i0.ɵɵelementStart(0, \"div\", 5)(1, \"div\", 6)(2, \"div\", 7)(3, \"div\", 8)(4, \"h4\", 9);\n    i0.ɵɵtext(5, \"Edit Course\");\n    i0.ɵɵelementEnd()();\n    i0.ɵɵelementStart(6, \"div\", 10)(7, \"form\", 11)(8, \"div\", 5)(9, \"div\", 12)(10, \"mat-form-field\", 13)(11, \"mat-label\");\n    i0.ɵɵtext(12, \"Select Branch \");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(13, \"mat-select\", 14);\n    i0.ɵɵtemplate(14, ManageCourseComponent_div_3_mat_option_14_Template, 2, 2, \"mat-option\", 15);\n    i0.ɵɵelementEnd()()()();\n    i0.ɵɵelementStart(15, \"div\", 5)(16, \"div\", 12)(17, \"mat-form-field\", 13)(18, \"mat-label\");\n    i0.ɵɵtext(19, \"Select Course \");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(20, \"mat-select\", 16);\n    i0.ɵɵtemplate(21, ManageCourseComponent_div_3_mat_option_21_Template, 2, 2, \"mat-option\", 15);\n    i0.ɵɵelementEnd()()()();\n    i0.ɵɵelementStart(22, \"div\", 5)(23, \"div\", 12)(24, \"mat-form-field\", 13);\n    i0.ɵɵelement(25, \"input\", 17);\n    i0.ɵɵelementEnd()();\n    i0.ɵɵelementStart(26, \"div\", 12)(27, \"mat-form-field\", 13);\n    i0.ɵɵelement(28, \"input\", 18);\n    i0.ɵɵelementEnd()()();\n    i0.ɵɵelementStart(29, \"div\", 5)(30, \"div\", 12)(31, \"mat-form-field\", 13);\n    i0.ɵɵelement(32, \"input\", 19);\n    i0.ɵɵelementEnd()();\n    i0.ɵɵelementStart(33, \"div\", 12)(34, \"mat-form-field\", 13);\n    i0.ɵɵelement(35, \"input\", 20);\n    i0.ɵɵelementEnd()()();\n    i0.ɵɵelementStart(36, \"button\", 21);\n    i0.ɵɵlistener(\"click\", function ManageCourseComponent_div_3_Template_button_click_36_listener() {\n      i0.ɵɵrestoreView(_r12);\n      const ctx_r11 = i0.ɵɵnextContext();\n      return i0.ɵɵresetView(ctx_r11.Update());\n    });\n    i0.ɵɵtext(37, \"Update\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelement(38, \"div\", 22);\n    i0.ɵɵelementEnd()()();\n    i0.ɵɵelementStart(39, \"div\", 7)(40, \"div\", 8)(41, \"h4\", 9);\n    i0.ɵɵtext(42, \"Add Course \");\n    i0.ɵɵelementEnd()();\n    i0.ɵɵelementStart(43, \"div\", 10);\n    i0.ɵɵtemplate(44, ManageCourseComponent_div_3_div_44_Template, 5, 1, \"div\", 23);\n    i0.ɵɵelementStart(45, \"form\", 11)(46, \"div\", 5)(47, \"div\", 12)(48, \"mat-form-field\", 13);\n    i0.ɵɵelement(49, \"input\", 24);\n    i0.ɵɵelementEnd()();\n    i0.ɵɵelementStart(50, \"div\", 12)(51, \"mat-form-field\", 13);\n    i0.ɵɵelement(52, \"input\", 25);\n    i0.ɵɵelementEnd()()();\n    i0.ɵɵelementStart(53, \"div\", 5)(54, \"div\", 12)(55, \"mat-form-field\", 13);\n    i0.ɵɵelement(56, \"input\", 26);\n    i0.ɵɵelementEnd()();\n    i0.ɵɵelementStart(57, \"div\", 12)(58, \"mat-form-field\", 13);\n    i0.ɵɵelement(59, \"input\", 27);\n    i0.ɵɵelementEnd()()();\n    i0.ɵɵelementStart(60, \"button\", 21);\n    i0.ɵɵlistener(\"click\", function ManageCourseComponent_div_3_Template_button_click_60_listener() {\n      i0.ɵɵrestoreView(_r12);\n      const ctx_r13 = i0.ɵɵnextContext();\n      return i0.ɵɵresetView(ctx_r13.Save());\n    });\n    i0.ɵɵtext(61, \"Save\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelement(62, \"div\", 22);\n    i0.ɵɵelementEnd()()()()();\n  }\n  if (rf & 2) {\n    const ctx_r1 = i0.ɵɵnextContext();\n    i0.ɵɵadvance(7);\n    i0.ɵɵproperty(\"formGroup\", ctx_r1.courseUpdateForm);\n    i0.ɵɵadvance(7);\n    i0.ɵɵproperty(\"ngForOf\", ctx_r1.Branch);\n    i0.ɵɵadvance(6);\n    i0.ɵɵproperty(\"formControlName\", ctx_r1.fields.course)(\"id\", ctx_r1.fields.course);\n    i0.ɵɵadvance();\n    i0.ɵɵproperty(\"ngForOf\", ctx_r1.Course);\n    i0.ɵɵadvance(4);\n    i0.ɵɵproperty(\"formControlName\", ctx_r1.fields.name)(\"id\", ctx_r1.fields.name)(\"value\", ctx_r1.name);\n    i0.ɵɵadvance(3);\n    i0.ɵɵproperty(\"formControlName\", ctx_r1.fields.description)(\"id\", ctx_r1.fields.description)(\"value\", ctx_r1.description);\n    i0.ɵɵadvance(4);\n    i0.ɵɵproperty(\"formControlName\", ctx_r1.fields.courseDuration)(\"id\", ctx_r1.fields.courseDuration)(\"value\", ctx_r1.courseDuration);\n    i0.ɵɵadvance(3);\n    i0.ɵɵproperty(\"formControlName\", ctx_r1.fields.price)(\"id\", ctx_r1.fields.price)(\"value\", ctx_r1.price);\n    i0.ɵɵadvance(9);\n    i0.ɵɵproperty(\"ngIf\", ctx_r1.selectedBranch);\n    i0.ɵɵadvance();\n    i0.ɵɵproperty(\"formGroup\", ctx_r1.courseSaveForm);\n    i0.ɵɵadvance(4);\n    i0.ɵɵproperty(\"formControlName\", ctx_r1.fields.name)(\"id\", ctx_r1.fields.name);\n    i0.ɵɵadvance(3);\n    i0.ɵɵproperty(\"formControlName\", ctx_r1.fields.description)(\"id\", ctx_r1.fields.description);\n    i0.ɵɵadvance(4);\n    i0.ɵɵproperty(\"formControlName\", ctx_r1.fields.courseDuration)(\"id\", ctx_r1.fields.courseDuration);\n    i0.ɵɵadvance(3);\n    i0.ɵɵproperty(\"formControlName\", ctx_r1.fields.price)(\"id\", ctx_r1.fields.price);\n  }\n}\nconst Updateform = new FormGroup({\n  name: new FormControl({\n    value: \"\",\n    disabled: false\n  }, [Validators.required]),\n  description: new FormControl({\n    value: \"\",\n    disabled: false\n  }, [Validators.required]),\n  courseDuration: new FormControl({\n    value: \"\",\n    disabled: false\n  }, [Validators.required]),\n  price: new FormControl({\n    value: \"\",\n    disabled: false\n  }, [Validators.required]),\n  course: new FormControl({\n    value: \"\",\n    disabled: false\n  }, [Validators.required])\n});\nconst Saveform = new FormGroup({\n  name: new FormControl({\n    value: \"\",\n    disabled: false\n  }, [Validators.required]),\n  description: new FormControl({\n    value: \"\",\n    disabled: false\n  }, [Validators.required]),\n  courseDuration: new FormControl({\n    value: \"\",\n    disabled: false\n  }, [Validators.required]),\n  price: new FormControl({\n    value: \"\",\n    disabled: false\n  }, [Validators.required])\n});\nexport let ManageCourseComponent = /*#__PURE__*/(() => {\n  class ManageCourseComponent {\n    constructor(bhakiService, notify, tokenService) {\n      this.bhakiService = bhakiService;\n      this.notify = notify;\n      this.tokenService = tokenService;\n      this.showResults = false;\n      this.name = \"\";\n      this.description = \"\";\n      this.courseDuration = \"\";\n      this.price = \"\";\n      this.Course = [];\n      this.fields = {\n        name: \"name\",\n        description: \"description\",\n        courseDuration: \"courseDuration\",\n        price: \"price\",\n        course: \"course\"\n      };\n      this.hideSpinner = true;\n      this.showSpinner = new BehaviorSubject(false);\n      this.courseUpdateForm = Updateform;\n      this.courseSaveForm = Saveform;\n      this.Branch = [];\n      this.disableEditFields(false);\n      this.disableCourseField(false);\n      this.getBranches();\n      this.userInfo = this.tokenService.getUser();\n    }\n    getCourse(branchId) {\n      this.showSpinner.next(true);\n      this.bhakiService.getCourses(branchId).subscribe({\n        next: res => {\n          this.showSpinner.next(false);\n          if (res.length > 0) {\n            this.Course = res;\n            this.disableCourseField(true);\n          } else {\n            this.disableCourseField(false);\n            this.notify.showNotification(\"bottom\", \"center\", \"No Course available for this branch, You can add a new course below\", \"warning\");\n          }\n        },\n        error: err => {\n          this.showSpinner.next(false);\n        }\n      });\n    }\n    ngOnInit() {\n      this.showSpinner.subscribe(res => {\n        this.hideSpinner = res;\n      });\n    }\n    validateBranchSelection(branch) {\n      this.courseUpdateForm.reset();\n      this.disableEditFields(false);\n      this.selectedBranch = branch;\n      this.getCourse(this.selectedBranch.id);\n    }\n    getBranches() {\n      this.showSpinner.next(true);\n      this.bhakiService.getBranches().subscribe({\n        next: res => {\n          this.showSpinner.next(false);\n          this.Branch = res;\n        },\n        error: err => {\n          console.log(err);\n          this.showSpinner.next(false);\n        }\n      });\n    }\n    Save() {\n      if (!this.selectedBranch) {\n        this.notify.showNotification(\"bottom\", \"center\", \"Please select a branch from above\", \"danger\");\n        return;\n      }\n      if (!this.courseSaveForm.valid) {\n        return;\n      }\n      const course = {\n        name: this.courseSaveForm.value.name,\n        description: this.courseSaveForm.value.description,\n        price: this.courseSaveForm.value.price,\n        courseDuration: this.courseSaveForm.value.courseDuration,\n        branchId: this.selectedBranch.id\n      };\n      this.showSpinner.next(true);\n      this.bhakiService.addCourse(course).subscribe({\n        next: res => {\n          this.showSpinner.next(false);\n          this.notify.showNotification(\"bottom\", \"center\", \"Course has been successfully added\", \"success\");\n          window.location.reload();\n        },\n        error: err => {\n          this.showSpinner.next(false);\n          console.log(err);\n        }\n      });\n    }\n    disableEditFields(enable) {\n      if (!enable) {\n        this.courseUpdateForm.controls[\"name\"].disable();\n        this.courseUpdateForm.controls[\"description\"].disable();\n        this.courseUpdateForm.controls[\"courseDuration\"].disable();\n        this.courseUpdateForm.controls[\"price\"].disable();\n      } else {\n        this.courseUpdateForm.controls[\"name\"].enable();\n        this.courseUpdateForm.controls[\"description\"].enable();\n        this.courseUpdateForm.controls[\"courseDuration\"].enable();\n        this.courseUpdateForm.controls[\"price\"].enable();\n      }\n    }\n    disableCourseField(enable) {\n      if (!enable) {\n        this.courseUpdateForm.controls[\"course\"].disable();\n      } else {\n        this.courseUpdateForm.controls[\"course\"].enable();\n      }\n    }\n    validateCourseSelection(course) {\n      this.clearValues();\n      this.disableEditFields(true);\n      this.selectedCourse = course;\n      this.name = course.name;\n      this.description = course.description;\n      this.courseDuration = course.courseDuration;\n      this.price = course.price;\n    }\n    clearValues() {\n      this.name = '';\n      this.description = '';\n      this.courseDuration = '';\n      this.price = '';\n    }\n    Update() {\n      if (this.name === \"\" || this.description === \"\") {\n        this.notify.showNotification(\"bottom\", \"center\", \"Please check your details\", \"danger\");\n      } else {\n        if (this.courseUpdateForm.value.name != \"\" && this.courseUpdateForm.value.name != null && this.courseUpdateForm.value.name != undefined) {\n          this.selectedCourse.name = this.courseUpdateForm.value.name;\n        } else {\n          this.selectedCourse.name = this.name;\n        }\n        if (this.courseUpdateForm.value.description != \"\" && this.courseUpdateForm.value.description != null && this.courseUpdateForm.value.description != undefined) {\n          this.selectedCourse.description = this.courseUpdateForm.value.description;\n        } else {\n          this.selectedCourse.description = this.description;\n        }\n        if (this.courseUpdateForm.value.courseDuration != \"\" && this.courseUpdateForm.value.courseDuration != null && this.courseUpdateForm.value.courseDuration != undefined) {\n          this.selectedCourse.courseDuration = this.courseUpdateForm.value.courseDuration;\n        } else {\n          this.selectedCourse.courseDuration = this.courseDuration;\n        }\n        if (this.courseUpdateForm.value.price != \"\" && this.courseUpdateForm.value.price != null && this.courseUpdateForm.value.price != undefined) {\n          this.selectedCourse.price = this.courseUpdateForm.value.price;\n        } else {\n          this.selectedCourse.price = this.price;\n        }\n        this.showSpinner.next(true);\n        this.bhakiService.updateCourses(this.selectedCourse).subscribe({\n          next: res => {\n            this.showSpinner.next(false);\n            this.notify.showNotification(\"bottom\", \"center\", \"Course has been successfully updated\", \"success\");\n            window.location.reload();\n          },\n          error: err => {\n            this.showSpinner.next(false);\n            console.log(err);\n          }\n        });\n      }\n    }\n    static #_ = this.ɵfac = function ManageCourseComponent_Factory(t) {\n      return new (t || ManageCourseComponent)(i0.ɵɵdirectiveInject(i1.HostService), i0.ɵɵdirectiveInject(i2.NotificationService), i0.ɵɵdirectiveInject(i3.TokenStorageService));\n    };\n    static #_2 = this.ɵcmp = /*@__PURE__*/i0.ɵɵdefineComponent({\n      type: ManageCourseComponent,\n      selectors: [[\"app-manage-course\"]],\n      decls: 4,\n      vars: 2,\n      consts: [[1, \"main-content\"], [1, \"container-fluid\"], [\"class\", \"loader\", 4, \"ngIf\"], [\"class\", \"row\", 4, \"ngIf\"], [1, \"loader\"], [1, \"row\"], [1, \"col-md-12\"], [1, \"card\"], [1, \"card-header\", \"card-header-danger\"], [1, \"card-title\"], [1, \"card-body\"], [3, \"formGroup\"], [1, \"col-md-6\"], [1, \"example-full-width\"], [\"required\", \"\"], [3, \"value\", \"click\", 4, \"ngFor\", \"ngForOf\"], [\"required\", \"\", 3, \"formControlName\", \"id\"], [\"matInput\", \"\", \"placeholder\", \"Name\", \"type\", \"text\", \"required\", \"\", 3, \"formControlName\", \"id\", \"value\"], [\"matInput\", \"\", \"placeholder\", \"Description\", \"type\", \"text\", \"required\", \"\", 3, \"formControlName\", \"id\", \"value\"], [\"matInput\", \"\", \"placeholder\", \"Course Duration\", \"type\", \"text\", \"required\", \"\", 3, \"formControlName\", \"id\", \"value\"], [\"matInput\", \"\", \"placeholder\", \"Price\", \"type\", \"number\", \"required\", \"\", 3, \"formControlName\", \"id\", \"value\"], [\"mat-raised-button\", \"\", \"type\", \"submit\", 1, \"btn\", \"btn-info\", \"pull-right\", \"button\", 3, \"click\"], [1, \"clearfix\"], [4, \"ngIf\"], [\"matInput\", \"\", \"placeholder\", \"Name\", \"type\", \"text\", \"required\", \"\", 3, \"formControlName\", \"id\"], [\"matInput\", \"\", \"placeholder\", \"Description\", \"type\", \"text\", \"required\", \"\", 3, \"formControlName\", \"id\"], [\"matInput\", \"\", \"placeholder\", \"Course Duration\", \"type\", \"text\", \"required\", \"\", 3, \"formControlName\", \"id\"], [\"matInput\", \"\", \"placeholder\", \"Price\", \"type\", \"number\", \"required\", \"\", 3, \"formControlName\", \"id\"], [3, \"value\", \"click\"]],\n      template: function ManageCourseComponent_Template(rf, ctx) {\n        if (rf & 1) {\n          i0.ɵɵelementStart(0, \"div\", 0)(1, \"div\", 1);\n          i0.ɵɵtemplate(2, ManageCourseComponent_div_2_Template, 1, 0, \"div\", 2)(3, ManageCourseComponent_div_3_Template, 63, 27, \"div\", 3);\n          i0.ɵɵelementEnd()();\n        }\n        if (rf & 2) {\n          i0.ɵɵadvance(2);\n          i0.ɵɵproperty(\"ngIf\", ctx.hideSpinner);\n          i0.ɵɵadvance();\n          i0.ɵɵproperty(\"ngIf\", !ctx.hideSpinner);\n        }\n      },\n      dependencies: [i4.NgForOf, i4.NgIf, i5.ɵNgNoValidate, i5.DefaultValueAccessor, i5.NumberValueAccessor, i5.NgControlStatus, i5.NgControlStatusGroup, i5.RequiredValidator, i5.FormGroupDirective, i5.FormControlName, i6.MatButton, i7.MatFormField, i7.MatLabel, i8.MatInput, i9.MatSelect, i10.MatOption],\n      styles: [\".navbar-form[_ngcontent-%COMP%]{max-width:450px}.loader[_ngcontent-%COMP%], .loader[_ngcontent-%COMP%]:before, .loader[_ngcontent-%COMP%]:after{background:#000;animation:_ngcontent-%COMP%_load1 1s infinite ease-in-out;width:1em;height:4em}.loader[_ngcontent-%COMP%]{color:#000;text-indent:-9999em;margin:17rem auto;position:relative;font-size:11px;transform:translateZ(0);animation-delay:-.16s}.loader[_ngcontent-%COMP%]:before, .loader[_ngcontent-%COMP%]:after{position:absolute;top:0;content:\\\"\\\"}.loader[_ngcontent-%COMP%]:before{left:-1.5em;animation-delay:-.32s}.loader[_ngcontent-%COMP%]:after{left:1.5em}@keyframes _ngcontent-%COMP%_load1{0%,80%,to{box-shadow:0 0;height:4em}40%{box-shadow:0 -2em;height:5em}}\"]\n    });\n  }\n  return ManageCourseComponent;\n})();","map":null,"metadata":{},"sourceType":"module","externalDependencies":[]}